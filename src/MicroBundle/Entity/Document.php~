<?php

namespace MicroBundle\Entity;

use DateTime;
use Doctrine\Common\Collections\ArrayCollection;
use Doctrine\ORM\Mapping as ORM;

/**
 * Document
 *
 * @ORM\Table(name="document")
 * @ORM\Entity(repositoryClass="MicroBundle\Repository\DocumentRepository")
 */
class Document
{
    /**
     * @var int
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string
     *
     * @ORM\Column(name="name", type="string", length=100)
     */
    private $name;

    /**
     * @var string
     *
     * @ORM\Column(name="scope", type="text")
     */
    private $scope;

    /**
     * @var string
     *
     * @ORM\Column(name="device_shortlist_position", type="text", nullable=true)
     */
    private $deviceShortlistPosition;

    /**
     * @var \DateTime
     *
     * @ORM\Column(name="inspection_date", type="datetime")
     */
    private $inspectionDate;

    /**
     * @var \DateTime
     *
     * @ORM\Column(name="next_inspection_date", type="datetime", nullable=true)
     */
    private $nextInspectionDate;

    /**
     * @var int
     *
     * @ORM\Column(name="next_inspection_for_month", type="integer", nullable=true)
     */
    private $nextInspectionForMonth;


    /**
     * Many Documents have Many Inspectors.
     * @ORM\ManyToMany(targetEntity="Inspector")
     * @ORM\JoinTable(name="document_inspectors",
     *      joinColumns={@ORM\JoinColumn(name="document_id", referencedColumnName="id")},
     *      inverseJoinColumns={@ORM\JoinColumn(name="inspector_id", referencedColumnName="id", unique=true)}
     *      )
     */
    private $inspectors;

    /**
     * @var string
     *
     * @ORM\Column(name="comment", type="text", nullable=true)
     */
    private $comment;

    /**
     * @var string
     *
     * @ORM\Column(name="recomendations", type="text", nullable=true)
     */
    private $recomendations;

    /**
     * @var string
     *
     * @ORM\Column(name="legal", type="text")
     */
    private $legal;

    /**
     * @var string
     *
     * @ORM\Column(name="conclusion", type="text", nullable=true)
     */
    private $conclusion;


    /**
     * One Document has Many docDevices.
     * @ORM\OneToMany(targetEntity="DocDevice", mappedBy="document", cascade={"persist"})
     */
    private $docDevices;

    /**
     * One Document has Many DocPosition.
     * @ORM\OneToMany(targetEntity="DocPosition", mappedBy="document", cascade={"persist"})
     */
    private $docPositions;

    /**
     * Many Document have One Building.
     * @ORM\ManyToOne(targetEntity="Building", inversedBy="documents", cascade={"persist"})
     * @ORM\JoinColumn(name="building_id", referencedColumnName="id")
     */
    private $building;

    /**
     * One Document has One PdfSettings
     * @ORM\OneToOne(targetEntity="PdfSettings", inversedBy="document", cascade={"persist"})
     * @ORM\JoinColumn(name="pdf_settings_id", referencedColumnName="id")
     */
    private $pdfSettings;



    /**
     * Constructor
     */
    public function __construct()
    {
        $this->inspectors = new ArrayCollection();
        $this->docDevices = new ArrayCollection();
        $this->inspectionDate = new DateTime();
        $this->nextInspectionDate = new DateTime('now + 6 month');
        $this->pdfSettings = new PdfSettings($this);
    }

}
